---
import { buttonVariants } from "../ui/button";
import { cn } from "../../lib/utils";
import type { Lang } from "@/config/languages";
import { Mail, ArrowRight } from "lucide-react";

interface Props {
    lang?: Lang;
    variant?: "full" | "compact" | "inline";
}

const { lang = "en", variant = "full" } = Astro.props;

const content = {
    en: {
        tagline: "Free Recovery Guide",
        heading: "Get Week-by-Week Recovery Tips",
        description:
            "Sign up for our free email course and receive expert guidance timed to your recovery phase. From the moment of injury to returning to sport.",
        emailPlaceholder: "you@example.com",
        cta: "Start Free Course",
        privacy: "We'll send weekly tips based on your injury date. Unsubscribe anytime.",
        compactHeading: "Want weekly recovery tips delivered to your inbox?",
        compactCTA: "Sign Up Free",
        inlineText: "Get weekly recovery tips with our",
        inlineLinkText: "free email course",
    },
    de: {
        tagline: "Kostenloser Genesungsleitfaden",
        heading: "Erhalten Sie wöchentliche Genesungstipps",
        description:
            "Melden Sie sich für unseren kostenlosen E-Mail-Kurs an und erhalten Sie Expertenführung, die auf Ihre Genesungsphase abgestimmt ist.",
        emailPlaceholder: "ihre@email.de",
        cta: "Kostenlos starten",
        privacy: "Wir senden wöchentliche Tipps basierend auf Ihrem Verletzungsdatum. Jederzeit abmelden.",
        compactHeading: "Möchten Sie wöchentliche Genesungstipps erhalten?",
        compactCTA: "Kostenlos anmelden",
        inlineText: "Erhalten Sie wöchentliche Tipps mit unserem",
        inlineLinkText: "kostenlosen E-Mail-Kurs",
    },
    fr: {
        tagline: "Guide de récupération gratuit",
        heading: "Recevez des conseils de récupération hebdomadaires",
        description:
            "Inscrivez-vous à notre cours par email gratuit et recevez des conseils d'experts adaptés à votre phase de récupération.",
        emailPlaceholder: "vous@example.com",
        cta: "Commencer gratuitement",
        privacy: "Nous enverrons des conseils hebdomadaires basés sur la date de votre blessure. Désabonnez-vous à tout moment.",
        compactHeading: "Voulez-vous recevoir des conseils de récupération hebdomadaires?",
        compactCTA: "S'inscrire gratuitement",
        inlineText: "Recevez des conseils hebdomadaires avec notre",
        inlineLinkText: "cours par email gratuit",
    },
    es: {
        tagline: "Guía de recuperación gratuita",
        heading: "Recibe consejos de recuperación semanales",
        description:
            "Inscríbete en nuestro curso por email gratuito y recibe orientación experta adaptada a tu fase de recuperación.",
        emailPlaceholder: "tu@email.com",
        cta: "Empezar gratis",
        privacy: "Enviaremos consejos semanales basados en la fecha de tu lesión. Cancela en cualquier momento.",
        compactHeading: "¿Quieres recibir consejos de recuperación semanales?",
        compactCTA: "Inscribirse gratis",
        inlineText: "Recibe consejos semanales con nuestro",
        inlineLinkText: "curso por email gratuito",
    },
    it: {
        tagline: "Guida al recupero gratuita",
        heading: "Ricevi consigli settimanali per il recupero",
        description:
            "Iscriviti al nostro corso email gratuito e ricevi una guida esperta adattata alla tua fase di recupero.",
        emailPlaceholder: "tu@email.it",
        cta: "Inizia gratis",
        privacy: "Invieremo consigli settimanali basati sulla data della tua lesione. Cancellati in qualsiasi momento.",
        compactHeading: "Vuoi ricevere consigli di recupero settimanali?",
        compactCTA: "Iscriviti gratis",
        inlineText: "Ricevi consigli settimanali con il nostro",
        inlineLinkText: "corso email gratuito",
    },
};

const t = content[lang];
---

{variant === "full" && (
    <section class="bg-neutral-50 dark:bg-neutral-900 py-16 md:py-24">
        <div class="mx-auto px-4 max-w-2xl text-center">
            <div class="inline-flex items-center gap-2 bg-green-100 dark:bg-green-900 mb-6 px-4 py-1.5 rounded-full font-medium text-green-800 dark:text-green-200 text-sm uppercase tracking-wide">
                <Mail className="w-4 h-4" />
                {t.tagline}
            </div>
            <h2 class="mb-4 font-bold text-neutral-900 dark:text-neutral-100 text-3xl">
                {t.heading}
            </h2>
            <p class="mb-8 text-neutral-600 dark:text-neutral-400">
                {t.description}
            </p>

            <form class="space-y-4 mx-auto max-w-md" action="/api/subscribe" method="POST">
                <div>
                    <input
                        type="email"
                        name="email"
                        required
                        placeholder={t.emailPlaceholder}
                        class="px-4 py-3 border border-neutral-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-primary w-full dark:bg-neutral-700 text-neutral-900 dark:text-neutral-100 text-center focus:outline-none"
                    />
                </div>
                <button
                    type="submit"
                    class={cn(
                        buttonVariants({
                            variant: "default",
                            size: "lg",
                        }),
                        "w-full justify-center gap-2",
                    )}
                >
                    <Mail className="w-4 h-4" />
                    {t.cta}
                </button>
            </form>
            <p class="mt-4 text-neutral-500 dark:text-neutral-400 text-xs">
                {t.privacy}
            </p>
        </div>
    </section>
)}

{variant === "compact" && (
    <div class="bg-green-50 dark:bg-green-900/20 my-8 p-6 border border-green-200 dark:border-green-800 rounded-xl">
        <div class="flex sm:flex-row flex-col justify-between items-center gap-4">
            <div class="flex items-center gap-3 sm:text-left text-center">
                <div class="flex justify-center items-center bg-green-100 dark:bg-green-900 rounded-lg w-10 h-10 shrink-0">
                    <Mail className="w-5 h-5 text-green-700 dark:text-green-300" />
                </div>
                <p class="font-semibold text-neutral-900 dark:text-neutral-100">
                    {t.compactHeading}
                </p>
            </div>
            <a 
                href="/guide"
                class={cn(buttonVariants({ variant: "default", size: "default" }), "whitespace-nowrap gap-2 bg-green-600 hover:bg-green-700")}
            >
                {t.compactCTA}
                <ArrowRight className="w-4 h-4" />
            </a>
        </div>
    </div>
)}

{variant === "inline" && (
    <p class="bg-green-50 dark:bg-green-900/20 my-4 p-4 border-green-500 border-l-4 rounded-lg text-neutral-600 dark:text-neutral-400">
        {t.inlineText}{" "}
        <a 
            href="/guide" 
            class="inline-flex items-center gap-1 font-medium text-green-700 dark:text-green-400 hover:underline"
        >
            {t.inlineLinkText}
            <ArrowRight className="w-3 h-3" />
        </a>.
    </p>
)}
