---
import FAQsLayout from "../../layouts/FAQsLayout.astro";
import TimelineBadge from "../../components/timeline/TimelineBadge.astro";
import TimelineBlock from "../../components/timeline/TimelineBlock.astro";
import FAQAccordion from "../../components/research/FaqSchemaAccordion.astro";
import NightSplintAdvert from "../../components/products/night-splint/NightSplintAdvert.astro";
import type { Lang } from "../../config/languages";
import { content } from "../../content/FAQs/achilles-rupture-timeline-content.ts";
import CourseCTA from "../../components/CTA/CourseCTA.astro";
import { buttonVariants } from "../../components/ui/button";
import { cn } from "../../lib/utils";
import { ArrowRight, BookOpen } from "lucide-react";

interface Props {
  lang: Lang;
}

const { lang = "en" } = Astro.props;
const t = content[lang];

// Define the detailed guide phases with links
const guidePhases = [
  {
    slug: "weeks-0-1",
    title: "Week 0-1: First Week After Rupture",
    description:
      "Emergency care, A&E expectations, blood clot prevention, and essential survival tips.",
  },
  {
    slug: "weeks-1-3",
    title: "Weeks 1-3: Treatment Decision",
    description:
      "Surgery vs conservative treatment, choosing your walking boot, and setting up for recovery.",
  },
  {
    slug: "weeks-4-6",
    title: "Weeks 4-6: Progressive Recovery",
    description:
      "Weight bearing progression, early exercises, and managing daily life.",
  },
  {
    slug: "weeks-7-9",
    title: "Weeks 7-9: Final Boot Phase",
    description:
      "Preparing to transition out of your boot, increasing activity, and building confidence.",
  },
  {
    slug: "weeks-10-12",
    title: "Weeks 10-12: Boot Transition",
    description:
      "Moving from boot to shoes, building strength, and returning to normal walking.",
  },
  {
    slug: "weeks-13-25",
    title: "Weeks 13-25: Progressive Strengthening",
    description:
      "Building strength and endurance, returning to activities, and preventing re-injury.",
  },
  {
    slug: "week-26-plus",
    title: "Week 26+: Return to Sport",
    description:
      "Full recovery assessment, return to running and sport, and long-term outlook.",
  },
];
---

<FAQsLayout title={t.title} description={t.description} lang={lang}>
  <section
    id="faq-slide"
    class="flex flex-col justify-center items-center mx-auto px-4"
  >
    <div class="relative mt-8 w-full max-w-4xl">
      {
        t.timelineBlocks.map((block, index) => (
          <TimelineBlock reverse={index % 2 === 0}>
            <Fragment slot="badge">
              <TimelineBadge time={block.time} variant={block.variant} />
            </Fragment>
            <Fragment slot="item">
              <h2 class="mb-2 font-semibold text-xl">{block.title}</h2>
              <div set:html={block.content} />
            </Fragment>
          </TimelineBlock>
        ))
      }
    </div>

    <!-- Detailed Guides Section -->
    <section class="mt-16 mb-8 w-full max-w-4xl">
      <div class="mb-8 text-center">
        <div
          class="inline-flex items-center gap-2 bg-primary/10 mb-4 px-4 py-1.5 rounded-full font-medium text-primary text-sm uppercase tracking-wide"
        >
          <BookOpen className="w-4 h-4" />
          Detailed Guides
        </div>
        <h2
          class="mb-4 font-bold text-neutral-900 dark:text-neutral-100 text-2xl md:text-3xl"
        >
          Read Our In-Depth Recovery Guides
        </h2>
        <p class="mx-auto max-w-2xl text-neutral-600 dark:text-neutral-400">
          Click on any phase below for a comprehensive, detailed guide with
          exercises, tips, and expert advice.
        </p>
      </div>

      <div class="gap-4 grid">
        {
          guidePhases.map((phase, index) => (
            <a
              href={`/guide/${phase.slug}`}
              class="group flex md:flex-row flex-col items-start md:items-center gap-4 bg-white hover:bg-neutral-50 dark:bg-neutral-800 dark:hover:bg-neutral-750 p-5 border border-neutral-200 hover:border-primary/50 dark:border-neutral-700 rounded-xl transition-all duration-300"
            >
              <div class="flex justify-center items-center bg-primary/10 rounded-lg w-12 h-12 font-bold text-primary text-lg shrink-0">
                {index + 1}
              </div>
              <div class="flex-1">
                <h3 class="mb-1 font-semibold text-neutral-900 dark:text-neutral-100 group-hover:text-primary text-lg transition-colors">
                  {phase.title}
                </h3>
                <p class="text-neutral-600 dark:text-neutral-400 text-sm">
                  {phase.description}
                </p>
              </div>
              <div class="flex items-center text-primary">
                <ArrowRight className="w-5 h-5 transition-transform group-hover:translate-x-1" />
              </div>
            </a>
          ))
        }
      </div>
    </section>

    <CourseCTA lang={lang} variant="full" />
    <FAQAccordion faqs={t.faqs} />
    <NightSplintAdvert lang={lang} />
  </section>
</FAQsLayout>

<style>
  .li-heading {
    @apply mt-2 pb-1 font-semibold text-neutral-700 list-none;
  }

  :global(.timeline-block:hover) {
    @apply scale-[1.02] transition-transform duration-200 transform;
  }

  :global(.timeline-badge) {
    @apply shadow-md;
  }

  @media print {
    .timeline-block {
      break-inside: avoid;
      page-break-inside: avoid;
    }
  }

  @media (max-width: 640px) {
    .timeline-block {
      margin-left: 1rem;
    }
  }

  html {
    scroll-behavior: smooth;
  }
</style>
